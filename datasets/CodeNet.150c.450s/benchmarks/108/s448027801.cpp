#if 0
?????¨?????????2h
bfs??????????????¢?´¢???????????°????????§?????????
????????????????´????????????\?????????????????????????????¨????????????????????£??????????????????queue?????????????????¢?????????
main?????§???????????§?§£????????£??\?????????to??£??\??????????????????????????£??????
????????????????????????????????????????????¨?????´?????????
#endif

#include <iostream>
#include <vector>
#include <queue>
using namespace std;

int n, D[100];
int G[100][100];
void bfs(int src){
	queue<int> q;
	q.push(src);
	D[src]=0;
	while(!q.empty()){
		int cur=q.front();
		q.pop();
		for(int dst=0;dst<n;dst++){
			if(G[cur][dst]==1&&D[dst]==-1){
				D[dst]=D[cur]+1;
				q.push(dst);
			}
		}
	}
};

int main()
{
	vector<int> v[110];
	cin>>n;
	for(int i=0;i<n;i++){
		int u,k;
		cin>>u>>k;
		for(int j=0;j<k;j++){
			int tmp;
			cin>>tmp;
			v[u].push_back(tmp);
		}
	}
	for(int i=0;i<100;i++){
		D[i]=-1;
	}
	for(int i=0;i<n;i++){
		for(int j=0;j<n;j++){
			G[i][j]=0;
		}
	}
	for(int i=1;i<n+1;i++){
		for(int j=0;j<v[i].size();j++){
			G[i-1][v[i][j]-1]=1; //
		}
	}
	bfs(0);
	for(int i=0;i<n;i++){
		cout<<(i+1)<<' '<<D[i]<<endl;
	}
}